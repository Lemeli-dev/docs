---
title: 'Customize Data Drift'
description: 'How to change data drift detection methods and conditions.'
noindex: "true"
---

All Metrics and Presets that evaluate shift in data distribitions use the default [Data Drift algorithm](/metrics/explainer_drift). It automatically selects an appropriate drift detection method based on the column type (text, categorical, numerical) and volume.

You can override the defaults by passing a custom parameter to the chosen Metric or Preset. You can modify the drift detection method (choose from 20+ available), thresholds, or both.

You can also implement fully custom drift detection methods.

**Pre-requisites**:

* You know how to use [Data Definition ](/docs/library/data_definition)to map column types.

* You know how to create [Reports](/docs/library/report) and run [Tests](/docs/library/tests).

## Data drift parameters

### Dataset-level

You can configure the share of drifting columns that is associated with the **dataset drift** (share of drifting columns in the dataset) in the relevant Metrics or Presets.

This will detect drift if over 70% are drifting.

```python
report = Report([
    DataDriftPreset(drift_share=0.7)
]
```

For Presets / Metrics that checks for drift in **multiple columns** at the same time, you can set a custom drift method for all columns, all numerical/categorical columns, or for each column individually.

For example, to set the data drift method that will apply to all columns in the dataset. (Requires the method to be supported for all column types).

```python
report = Report([
    DataDriftPreset(drift_share=0.7, stattest="psi")
]
```

This configures PSI as as drift detection method for categorical columns only, with threshold of 0.5. (If the value is higher, drifted detected for this column).

```python
report = Report([
    DataDriftPreset(cat_stattest="psi", cat_stattest_threshold="0.5")
]
```

<Note>
  Note that this works differently from the usual Test conditions API (with `gt`, `lt`, etc.) This allows to automatically account for nuances like understanding that different drift detection methods have different interpretation of the threshold: depending on the method, greater can be better or worse.
</Note>

### Column-level

When you are using column-level metrics, you can set the condition directly for each evaluated column:

```python
report = Report([
    ValueDrift(column="Salary", stattest="psi")
]
```

### All parameters

| Parameter                                                  | Description                                                                                                                                                                                                                | Applies To                                                   |
| ---------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------ |
| `stattest`                                                 | Defines the drift detection method for a given column (if one column is tested), or all columns in the dataset (if multiple columns are tested and the test can apply to all columns).                                     | `ValueDrift()`, `DriftedColumnsCount()`, `DataDriftPreset()` |
| `stattest_threshold`                                       | Sets the drift threshold in a given column or all columns.<br /><br />The threshold meaning varies based on the drift detection method, e.g., it can be the value of a distance metric or a p-value of a statistical test. | `ValueDrift()`, `DriftedColumnsCount()`, `DataDriftPreset()` |
| `drift_share`                                              | Defines the share of drifting columns as a condition for Dataset Drift.                                                                                                                                                    | `DriftedColumnsCount()`, `DataDriftPreset()`                 |
| `cat_stattest` <br />`cat_stattest_threshold`              | Sets the drift method and/or threshold for all categorical columns in the dataset.                                                                                                                                         | `DriftedColumnsCount()`, `DataDriftPreset()`                 |
| `num_stattest` <br />`num_stattest_threshold`              | Sets the drift method and/or threshold for all numerical columns in the dataset.                                                                                                                                           | `DriftedColumnsCount()`, `DataDriftPreset()`                 |
| `per_column_stattest`<br />`per_column_stattest_threshold` | Sets the drift method and/or threshold for the listed columns (accepts a dictionary).                                                                                                                                      | `DriftedColumnsCount()`, `DataDriftPreset()`                 |
| `text_stattest` <br /> `text_stattest_threshold`           | Defines the drift detection method and threshold for all text columns in the dataset.                                                                                                                                      | `DriftedColumnsCount()`, `DataDriftPreset()`                 |

## Data drift detection methods

### Tabular data

The following methods and parameters apply to **tabular** data (numerical or categorical columns in data definition). Pass them using the `stattest` (or `num_stattest`, etc.) parameter.

| StatTest                                          | Applicable to                                                                                                       | Drift score                                                                                          |
| ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- |
| `ks`<br />Kolmogorov–Smirnov (K-S) test           | tabular data<br />only numerical <br /><br />**Default method for numerical data, if ≤ 1000 objects**               | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `chisquare`<br />Chi-Square test                  | tabular data<br />only categorical<br /><br />**Default method for categorical with > 2 labels, if ≤ 1000 objects** | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `z`<br /> Z-test                                  | tabular data<br />only categorical<br /><br />**Default method for binary data, if ≤ 1000 objects**                 | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `wasserstein`<br /> Wasserstein distance (normed) | tabular data<br />only numerical<br /><br />**Default method for numerical data, if > 1000 objects**                | returns `distance`<br />drift detected when `distance` ≥ `threshold`<br />default threshold: 0.1     |
| `kl_div`<br />Kullback-Leibler divergence         | tabular data<br />numerical and categorical                                                                         | returns `divergence`<br />drift detected when `divergence` ≥ `threshold`<br />default threshold: 0.1 |
| `psi`<br /> Population Stability Index (PSI)      | tabular data<br />numerical and categorical                                                                         | returns `psi_value`<br />drift detected when `psi_value` ≥ `threshold`<br />default threshold: 0.1   |
| `jensenshannon`<br /> Jensen-Shannon distance     | tabular data<br />numerical and categorical<br /><br />**Default method for categorical, if > 1000 objects**        | returns `distance`<br />drift detected when `distance` ≥ `threshold`<br />default threshold: 0.1     |
| `anderson`<br /> Anderson-Darling test            | tabular data<br />only numerical                                                                                    | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `fisher_exact`<br /> Fisher's Exact test          | tabular data<br />only categorical                                                                                  | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `cramer_von_mises`<br /> Cramer-Von-Mises test    | tabular data<br />only numerical                                                                                    | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `g-test`<br /> G-test                             | tabular data<br />only categorical                                                                                  | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `hellinger`<br /> Hellinger Distance (normed)     | tabular data<br />numerical and categorical                                                                         | returns `distance`<br />drift detected when `distance` >= `threshold`<br />default threshold: 0.1    |
| `mannw`<br /> Mann-Whitney U-rank test            | tabular data<br />only numerical                                                                                    | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `ed`<br /> Energy distance                        | tabular data<br />only numerical                                                                                    | returns `distance`<br />drift detected when `distance >= threshold`<br />default threshold: 0.1      |
| `es`<br /> Epps-Singleton test                    | tabular data<br />only numerical                                                                                    | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `t_test`<br /> T-Test                             | tabular data<br />only numerical                                                                                    | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `empirical_mmd`<br /> Empirical-MMD               | tabular data<br />only numerical                                                                                    | returns `p_value`<br />drift detected when `p_value < threshold`<br />default threshold: 0.05        |
| `TVD`<br /> Total-Variation-Distance              | tabular data<br />only categorical                                                                                  | returns `p_value`<br />drift detected when `p_value` \< `threshold`<br />default threshold: 0.05     |

### Text data

Text drift detection applies to columns with **raw text data**, as specified in data definition. Pass them using the `stattest` (or `text_stattest`) parameter.

| StatTest                                                                                                    | Description                                                                                                                                                                                   | Drift score                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ----------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `perc_text_content_drift`<br /> Text content drift (domain classifier, with statistical hypothesis testing) | Applies only to text data. Trains a classifier model to distinguish between text in “current” and “reference” datasets.<br /><br />**Default for text data when less or eq to 1000 objects.** | <ul><li>returns `roc_auc` of the classifier as a `drift_score`</li><li>drift detected when `roc_auc` > possible ROC AUC of the random classifier at a set percentile</li><li>`threshold` sets the percentile of the possible ROC AUC values of the random classifier to compare against</li><li>default threshold: 0.95 (95th percentile)</li><li> `roc_auc` values can be 0 to 1 (typically 0.5 to 1); a higher value means more confident drift detection</li></ul> |
| `abs_text_content_drift`<br /> Text content drift (domain classifier)                                       | Applies only to text data. Trains a classifier model to distinguish between text in “current” and “reference” datasets.<br /><br />**Default for text data when > 1000 objects.**             | <ul><li>returns `roc_auc` of the classifier as a `drift_score`</li><li>drift detected when `roc_auc` > `threshold` </li><li>`threshold` sets the ROC AUC threshold</li><li>default threshold: 0.55</li><li> `roc_auc` values can be 0 to 1 (typically 0.5 to 1); a higher value means more confident drift detection</li></ul>                                                                                                                                        |

**Text descriptors drift**. If you work with raw text data, you can also check for distribution drift in text descriptors (such as text length, etc.) To use this method, first compute the selected [text descriptors](/docs/library/descriptors). Then, use numerical / categorical drift detection methods as usual.

## Add a custom method

If you do not find a suitable drift detection method, you can implement a custom function.

```
from scipy.stats import anderson_ksamp
from evidently import ColumnType
from evidently.calculations.stattests import register_stattest
from evidently.calculations.stattests import StatTest

from evidently.future.report import Report

from evidently.future.metrics import DriftedColumnsCount
from evidently.future.metrics import ValueDrift


def _addd(
    reference_data: pd.Series,
    current_data: pd.Series,
    feature_type: ColumnType,
    threshold: float,
):
    p_value = anderson_ksamp([reference_data.values, current_data.values])[2]
    return p_value, p_value < threshold


adt = StatTest(
    name="adt",
    display_name="Anderson-Darling",
    allowed_feature_types=[ColumnType.Numerical],
    default_threshold=0.1,
)

register_stattest(adt, default_impl=_addd)


report = Report([
    # ValueDrift(column="column_1"),
    ValueDrift(column="column_1", method="adt"),
    DriftedColumnsCount(),
])

snapshot = report.run(dataset, dataset)
snapshot
```

The StatTest function should match `(reference_data: pd.Series, current_data: pd.Series, threshold: float) -> Tuple[float, bool]` signature:

* `reference_data: pd.Series` - reference data series

* `current_data: pd.Series` - current data series to compare

* `feature_type: str` - feature type

* `threshold: float` - Stat Test threshold for drift detection

Returns:

* `score: float` - Stat Test score (actual value)

* `drift_detected: bool` - indicates is drift detected with given threshold

To use the StatTest function, we recommended writing a specific instance of the StatTest class for that function. To create the instance of the `StatTest` class, you need:

* `name: str` - a short name used to reference the Stat Test from the options (the StatTest should be registered globally)

* `display_name: str` - a long name displayed in the Dashboard and Profile

* `func: Callable` - a StatTest function

* `allowed_feature_types: List[str]` - the list of allowed feature types to which this function can be applied (available values: `cat`, `num`)